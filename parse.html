<!DOCTYPE html>
<html>
<body>

<table id="deck" border=2 cellpadding=2>
</table>

<script>

parseXML("tickets.xml");

function parseXML(xml){
	var xhttp = new XMLHttpRequest();
	xhttp.onreadystatechange = function() {
		if (xhttp.readyState == 4 && xhttp.status == 200) {
			parsing(xhttp);
		}
	};
	xhttp.open("GET", xml, true);
	xhttp.send();
}

function parsing(xhttp) {
	var xmlDoc = xhttp.responseXML;
	
	var table = document.getElementById("deck");
	var length = xmlDoc.getElementsByTagName("ticket").length;
	
	var tickets = new Array();
	
	for (var i = 0; i < length; i++) {
	
		var newRow = table.insertRow(i);
		var newCell = newRow.insertCell(0);
		
		var ticket_info = "";
		var additional_text = "";
		var node, childNodes = xmlDoc.getElementsByTagName("ticket")[i].childNodes;
		
		tickets[i] = {
			departure: "None",
			arrival: "None",
			text: "None"
		}
		
		var j = 1;
		while(j < childNodes.length ){
			node = childNodes.item(j);
			switch(node.nodeName) {
				case "transport":
					additional_text = "Take the ";
					break;
				case "departure":
					additional_text = " from ";
					tickets[i].departure = node.textContent;
					break;
				case "arrival":
					additional_text = " to ";
					tickets[i].arrival = node.textContent;
					break;
				case "gate":
					additional_text = ". Gate: ";
					break;
				case "seat":
					additional_text = ". Seat: ";
					break;
				case "baggage":
					additional_text = ". Baggage ";
					break;
				default: 
					additional_text = " " + node.nodeName + " ";
				break;
			}
			ticket_info = ticket_info + additional_text + node.textContent;
			j = j + 2;
		}
		
		tickets[i].text = ticket_info + ".";
		
		newCell.innerHTML = "<p>Departure: " + tickets[i].departure + "</p><p>Arrival: " + tickets[i].arrival + "</p><p>" + tickets[i].text + "</p>";

	}
}
</script>

</body>
</html> 
